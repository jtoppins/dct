# Templates

## Usage

A template represents a non-unique DCT game object. These objects can be
copied to represent unique game objects within the DCT/DCS game world. The
primary usage for Template objects is to validate user/mission-creator
provided game data in a consistent and common way. This removes the
responsibility of Asset objects from having to perform this validation each
time.

## Storage

Templates are stored in a combination of `.dct` (known as 'DCT files') and
`.stm` (known as 'STM files') files with the same named file, but with
different post-fix comprise the entire template definition. DCT files are
the only files needed to fully define a template. STM files come from the
DCS mission editor's static template feature, which allows a mission
designer to compose groups of DCS objects in a semi-visual way without having
to redo the work over-and-over in new mission files.

## Attributes - General

_NOTE:_ Things noted as required mean the DCT file associated with the
template must define the attribute.

### `objtype`

 * _required:_ yes
 * _value:_ string

Defines the type of game object (Asset) that will be created from the
template. Allowed values can be found in
[src/dct/enum.lua](../../../src/dct/enum.lua) in the `assetType` table.

### `name`

 * _required:_ depends
 * _value:_ string

The name of the template. This name can be used to lookup the template from
the Region object. If the template uses an STM file then the name field of the
STM template will be used. This name field is editable in the mission editor.
If the template is an airbase type the name must reference an airbase object
in the game world or define a tpldata to spawn a new airbase. This airbase
validation is not done at template definition time and is instead done at
asset creation time, thus it is a non-fatal error generating a warning in
the log file. The asset will not be created if the name or tpldata is
incorrect or does not exist.

### `regionname`

 * _required:_ depends
 * _value:_ string

The region name the template belongs to. If a template is created outside the
theater definition directory this region will need to be defined.

### `coalition`

 * _required:_ depends
 * _value:_ "red", "blue", "neutral" (case doen't matter)
 * _default:_ the coalition the DCS groups/statics belong too or this field is
   **required**

A template can only belong to a single coalition (side) and any DCS
groups/statics not belonging to the same side as the first group will cause a
fatal error. This can be confusing sometimes when a template is attempted
to be used across different campaigns. Your campaign designer should come up
with a standard country set for each coalition.

### `desc`

 * _required:_ no
 * _value:_ string

This is a text string field used to provide the 'target briefing' text when a
mission is assigned to a player. This text can use string replacement to make
certain parts of the message variable, the replacement fields are:

 * `LOCATIONMETHOD` - provides a randomly selected description of how the
   target was discovered.
 * `TOT` - replaces with the expected time-on-target

### `tpldata`

 * _required:_ depends
 * _value:_ table
 * _default:_ autogenerated if STM is provided otherwise required if DCS
   in-game objects need to be associated with the template

For templates that are not associated with an STM file the format of `tpldata`
follows:

	tpldata = {
	    # = {
	      category = Unit.Category,
	      countryid = id,
	      data      = {
	        # group def members
	        dct_deathgoal = goalspec
	      },
	}}

See [tpldata details][tpldata_details] for more information on specification
of death goals and naming criteria.

### `buildings`

 * _required:_ no
 * _value:_ table
 * _default:_ nil

Allows the campaign designer to specify scenery objects as part of the
template. The definition is a list of scenery objects that should
be included as part of the template, an example from the Persian Gulf
map;

	...
	["buildings"] = {
		{
			["name"] = "building 1",
			["goal"] = "primary destroyed",
			["id"]   = 109937143,
		},
	},
	...

Where `name` is the name of the scenery object (is arbitrary and only
referenced in DCT for error reporting), `goal` conforms to the textual
goalspec, and `id` is the map specific object id which can be obtained
from the mission editor.

### `uniquenames`

 * _required:_ no
 * _value:_ boolean
 * _default:_ false

When a template can represent more than one instance of an Asset this
attribute should be set to `true` so when a new Asset is created the names of
the DCS objects are made unique. This way when the DCS objects are dynamically
spawned DCS will not despawn previously spawned objects because they have the
same name.

### `priority`

 * _required:_ no
 * _value:_ number, lower means higher priority
 * _default:_ depending on `objtype` an appropriate value will be selected

This field defines the relative priority to other templates/assets within the
region. A lower non-negative number means higher priority.

### `primary`

 * _required:_ no
 * _value:_ `true` or `false`
 * _default:_ `false`

Defines if an Asset created from this template is considered a 'primary'.
Depending on the overall theater goals all or a percentage of all primary
targets must be destroyed.

### `intel`

 * _required:_ no
 * _value:_ `0` to `5`
 * _default:_ `0`

Defines the initial amount of 'intel' the opposing side knows about any assets
generated from the template. The intel value is a direct representation to how
many decimal places the location of the asset will be truncated to[\[2\]][2].

### `spawnalways`

 * _required:_ no
 * _value:_ `true` or `false`
 * _default:_ `false`

Used to identify templates that should always be spawned, the value should
always be 'true' or removed from the template definition.

### `exclusion`

 * _required:_ no
 * _value:_ string

Used to mark templates that should not be spawned together. If the templates
have the same string value the templates will be grouped together and only
one template from the exclusion group will be selected. All other members
of the group will be ignored.

### `airbase`

 * _required:_ no
 * _value:_ string
 * _default:_ nil

Specifies which airbase the asset is associated with.

## Attributes - Type Specific

### Airspace

#### `location`

 * _required:_ yes
 * _value:_ table

Is the centroid where the airspace is located.

#### `volume`

 * _required:_ yes
 * _value:_ table

Is a DCS volume spec[\[3\]][3] defining the airspace being taken up.

### Airbase

#### `subordinates`

 * _required:_ no
 * _value:_ table
 * _default:_ none

A list of template names that will be converted into DCT assets. These
templates are usually base defenses or squadrons but there is nothing
preventing the designer from spawning additional assets with this list.

#### `contest_dist`

 * _required:_ no
 * _value:_ number
 * _default:_ 10 nautical miles for land bases, disabled for ships

The distance opposing troops are allowed to come within before the
airbase is considered contested and the ability to launch aircraft
will be disabled.

### Squadron

#### `planedata`

 * _required:_ no
 * _value:_ table

Defines the metatdata related to the squadron.
Allowed fields inside `planedata`:

**Common Options:**

##### `ato`

 * _required:_ no
 * _value:_ list of strings
 * _default:_ all mission types allowed

The allowed mission types the squadron can fly.

##### `max`

 * _required:_ no
 * _value:_ number
 * _default:_ `-1`

Maximum number of airframes the squadron can have, by default unlimited (-1).

##### `current`

 * _required:_ no
 * _value:_ number
 * _default:_ `-1`

Current number of airframes a squadron has on hand, by default unlimited (-1).

##### `flightsize`

 * _required:_ no
 * _value:_ number
 * _default:_ `1`

The size of the flight, used for calculating available number of possible
missions the squadron can take.

**AI Squadron:**

##### `experience`

 * _required:_ no
 * _value:_ table
 * _default:_ `{2, 1}`

Average experience level of the squadron, of the form `{<mean>,<sigma>}`,
where `<mean>` is the average experience level and `<sigma>` is the
variability from the mean.

##### `readytime`

 * _required:_ no
 * _value:_ table
 * _default:_ `{300, 90}`

Amount of time it takes to ready a plane for takeoff, of the form
`{<mean>,<sigma>}`, where `<mean>` is the average time and `<sigma>`
is the variability from the mean.

##### `alerttime`

 * _required:_ no
 * _value:_ table
 * _default:_ `{120, 45}`

Amount of time it takes to ready a plane on alert status, of the form
`{<mean>,<sigma>}`, where `<mean>` is the average time and `<sigma>`
is the variability from the mean.

**Player Squadron:**

##### `payloadlimits`

 * _required:_ no
 * _value:_ table
 * _default:_ no limit

A table listing the cost limit for different ordinance groups, by default
there is no limit. The format of the table is as follows:

			["payloadlimits"]  = {
				["ag"] = 20,
				["aa"] = 10,
			}

##### `gridfmt`

 * _required:_ no
 * _value:_ string
 * _default:_ `dms`

The grid format used when reporting coordinates to players, if empty an
appropriate default will be used.

## Template Data - DCS Object Definition

[1]: https://wiki.hoggitworld.com/view/DCS_enum_coalition "Hoggit Wiki - Coalition Table"
[2]: https://en.wikipedia.org/wiki/Decimal_degrees "Decimal degrees"
[3]: https://wiki.hoggitworld.com/view/DCS_func_searchObjects "DCS Volume Spec"
